var app=angular.module("app",["chart.js","ngRoute"]);app.config(["$routeProvider",function(e){e.when("/cities",{controller:"cityController",templateUrl:"cities.html"}).when("/list",{controller:"ssnController",templateUrl:"list.html"}).otherwise({controller:"homeController",templateUrl:"welcome.html"})}]),app.factory("ssnFactory",[function(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate();return{isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},age:function(e){if(void 0!==e){var o=Number(e.slice(0,2)),a=Number(t.toString().slice(2));o<10&&(o="0"+o),o=o>=a?"19"+o:"20"+o;var i=t-o,c=e.slice(2,4),s=e.slice(4,6);return r<c?i--:r==c&&n<s&&i--,i}},validSsn:function(e){if(void 0!==e){var r=e.slice(0,2),n=t.toString();n=n.slice(2),r=r>n?"19"+r:"20"+r;var o=e.slice(2,4),a=e.slice(4,6);if(o<1||o>12)return!1;if(a<1)return!1;switch(Number(o)){case 1:case 3:case 5:case 7:case 8:case 10:case 12:if(a>31)return!1;break;case 4:case 6:case 9:case 11:if(a>30)return!1;break;case 2:if(this.isLeapYear(Number(r))){if(a>29)return!1}else if(a>28)return!1}for(var i=e.slice(0,6)+e.slice(7,10),c=[],s=0,l=!0,u=0,p=0;p<i.length;p++)s=i.slice(p,p+1),l?(s*=2,l=!1):(s*=1,l=!0),c.push(s);for(var f=0;f<9;f++)u+=c[f]>=10?c[f]-9:c[f];newSum=u.toString(),2==newSum.length&&(u=newSum.slice(1)),u=10-u;return e.slice(10)==u}}}}]),app.factory("cityFactory",["$http",function(e){var t=[],r=[],n=[];return{fetch:function(){return e.get("http://cities.jonkri.se/0.0.0/cities").then(function(e){r.splice(0,r.length),n.splice(0,n.length),t=e.data.items;for(var o=0;o<t.length;o++)r.push(t[o].name),n.push(t[o].population)})},post:function(r,n){return e.post("http://cities.jonkri.se/0.0.0/cities",{name:r,population:n}).then(function(e){t=e})},getName:function(){return r},getPopulation:function(){return n}}}]),app.run(["$rootScope",function(e){e.name=""}]),app.filter("capitalize",function(){return function(e){return e?e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}}),app.directive("validateSsn",["$rootScope","ssnFactory",function(e,t){return{require:"ngModel",restrict:"A",link:function(e,r,n,o){o.$validators.validateSsn=function(e,r){return t.validSsn(r)}}}}]),app.controller("cityController",["$scope","$http","$rootScope","cityFactory",function(e,t,r,n){e.name=n.getName(),e.population=n.getPopulation(),n.fetch(),e.addCity=function(){e.errorMessage=!0,e.addCityName&&e.addCityPopulation&&(n.post(e.addCityName,e.addCityPopulation),e.addCityName="",e.addCityPopulation="",e.errorMessage=!1)}}]),app.controller("ssnController",["$scope","$rootScope","ssnFactory",function(e,t,r){e.isLeapYear=r.isLeapYear,e.validSsn=r.validSsn,e.age=r.age}]),app.controller("homeController",["$scope","$rootScope",function(e,t){e.addName=function(){t.name=e.whatsYourName,t.age=e.howOldAreYou,e.whatsYourName=""}}]);